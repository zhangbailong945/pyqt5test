<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vue Todo</title>
  <style>
    .completed {
      text-decoration: line-through;
    }

    .selected {
      color: red;
    }
  </style>
</head>
<body>
<div id="todo-app">
  <div>
    <input type="button" value="全部标为完成"/>
    <input type="text" placeholder="添加 todo"
    v-model="newTodoTitle"
    @keyup.enter="addTodo"
    />
  </div>
  <!-- todo list -->
  <ul>
    <li v-for='todo in todos' :key='todo.id'>
      <span :class="{completed: todo.completed}" :class="{finished: todo.finished}" @dblclick="editTodo(todo)">{{ todo.title }}</span>
      <input type="button" value="标为完成" @click="markAsCompleted(todo)">
      <input type="button" value="删除" @click="removeTodo">
      <input type="text" v-focus="true" value="编辑 todo..." v-model="todo.title" @keyup.enter="editDone(todo)" @keyup.esc="cancelEdit(todo)" v-if="editedTodo!==null && editedTodo.id==todo.id" />
    </li>
  <!-- end todo list -->
  <div>
    <span>剩余{{ noCompletedCount }}项未完成 ---</span>
    <span>筛选：
      <input type="button" @click="markAsAllCompleted" class="selected" value="全部">
      <input type="button" value="进行中">
      <input type="button" value="已完成">
      <input type="button" value="清除已完成">
      <input type="button" value="清除全部">
    </span>
  </div>
</div>
</body>
<script src="https://cdn.bootcss.com/vue/2.5.16/vue.js"></script>
<script>
    let id=0;
var app=new Vue({

    el:'#todo-app',
    data:function(){
        return {
            todos:[
                {id:0,title:'学习Vue',completed:false},
                {id:1,title:'整个项目',completed:false},
                {id:2,title:'迎娶白富美走上人生巅峰',completed:false},
            ],
            newTodoTitle:'',
            editedTodo:null,
        }
    },
    computed:{
      noCompletedCount:function(){
        return this.todos.filter(todo=>!todo.completed).length
      }
    },
    directives:{
      focus:{
        inserted:function(el){
          el.focus()
        }
      }
    },
    methods:{
      addTodo:function(){
        this.todos.push({id:id++,title:this.newTodoTitle,completed:false}),
        this.newTodoTitle=''
      },
      removeTodo:function(todo){
        this.todos.splice(this.todos.indexOf(todo),1)
      },
      markAsCompleted:function(todo){
        todo.completed= true
      },
      editTodo:function(todo){
        this.editedTodo={id:todo.id,title:todo.title}
      },
      editDone:function(todo){
        this.editedTodo=null
      },
      cancelEdit:function(todo){
        todo.title=this.editedTodo.title
        this.editedTodo=null
      },
      markAsAllCompleted:function(){
        this.todos.map(function(todo){
          if(!todo.completed){
            todo.completed=true
          }
        })
      }
    },
})
</script>
</html>